# Immunotherapy Microbiome Analysis (PRJEB61942) 

This repository contains all scripts and ressources related to the analysis of the PRJEB61942 dataset, which investigates the link between the microbiome and response to immunotherapy in melanoma patients.


## Workflow: 

### 1. Data selection
From the ENA metadata, I selected only the **16S rRNA** samples based on the "tax_id=9606" and confirmed the sequencing method 

### 2. Downloading the FASTQ files 
Using a script ("downlaod_fastq.sh"), I downloaded all paired-end FASTQ files related to 16S sequencing from the ENA FTP links

### 3. Files integrity check 
To make sure files were correctly downloaded: 
- I used the **md5 checksums** provided in the metadata
- I wrote a bash script ("verify_md5.sh") to compare them with local files
- A log of passed and failed checks was created
  
### 4. Quality control with fastp 
I ran fastp on all paired-end FASTQ files using default settings 
It cleaned low-quality reads and generated reports. 

### 5. Quality summary and filtering decision
An R script ("scripts/fastp_summary.r") was created to parse the JSON reports generated by fastp.
It extracts important metrics (number of reads before and after filtering, Q20 and Q30 rates), summarizes them into a tale and produces multiple visualizations. 
**Key observations:**
* Q20 and Q30 scores remain high for all samples
* The main filtering criterion was he number of reads after filtering.

So finally, only samples with less than 30,000 reads after filtering were excluded from downstream analysis.
A detailed visual report explaining this is available: "metadata/fastp_summary_report.pdf" 

## File structure: 

### scripts:
* download_fastq.sh    #download FATSQ files from ENA
* verify_md5.sh        #check the md5 integrity of downloaded files
* run_fastp.sh         #quality filtering with fastp
* fastp_summary.r      #generate plots and summary from fastp JSON reports 

### metadata: 
* filereport_16S.txt   #cleaned metadata with 16S samples
* fastq_links_16S.txt  #list of FASTQ URLs to download
* filereport_16S_filtered.tsv  #metadata filtered to keep only good quality samples
* fastp_summary_table.csv   #CSV table with reads and quality scores

### logs: 
* md5_check_ok.txt     #files that passed the md5 check
* md5_check_fail.txt   #files that failed or were missing
* log_download.txt     #output log of the download script

### others
* fastp_summary_report.pdf #visual explaination of filtering decisions 


